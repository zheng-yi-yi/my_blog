---
title: 快速上手
category: 框架
tag:
  - C#
  - .NET
  - ASP.NET Core
order: 2
date: 2024-07-18
---

## todo list

下面，我们一起跟着官方文档，构建一个简单的代办事项应用程序。

## 创建解决方案

首先，请确保你已经安装了 ABP CLI，可运行以下命令来安装它：

```shell
dotnet tool install -g Volo.Abp.Cli
```

接着，打开你的工作目录，运行以下命令：

```shell
abp new TodoApp -u angular
```

上述命令使用 `ABP CLI` 创建了一个解决方案，名为 "`TodoApp`"，同时使用 `Angular` 作为其前端UI框架。

完成后，我们就得到一个预配置的全栈应用程序，此时包含两个文件夹：

![项目根目录](images/02_快速入门/image-20240718092608461.png)

## 创建并初始化数据库

我们用 Visual Studio 打开 `aspnet-core` 项目下的解决方案 `TodoApp.sln`，然后右键单击`TodoApp.DbMigrator`项目，将其配置为启动项目：

![设置启动项目](images/02_快速入门/image-20240718093838652.png)

接着运行该项目，此时会**创建数据库并生成初始数据**：

![运行项目](images/02_快速入门/image-20240718093330353.png)

## 运行应用程序

我们再将启动项目设置为 `TodoApp.HttpApi.Host` ，该项目承载服务器端HTTP API。

![运行TodoApp.HttpApi.Host项目](images/02_快速入门/image-20240718094953540.png)

项目运行成功后会自动打开浏览器，访问该项目的 [Swagger UI](https://swagger.io/tools/swagger-ui/) 页面，此时我们可以查看服务端的 HTTP API。

如果出现以下错误：

```bash
Unable to bind to https://localhost:44315 on the IPv4 loopback interface: '以一种访问权限不允许的方式做了一个访问套接字的尝试。'.
```

![404错误](images/02_快速入门/image-20240718095231504.png)

那可能是因为端口已经被另一个应用程序占用，我们可以手动修改端口，请修改项目的配置文件，将访问端口改为其他的，比如 `44316`：

![修改端口](images/02_快速入门/image-20240718095357570.png)

`TodoApp.HttpApi.Host`项目成功运行后的界面如下：

![项目运行效果](images/02_快速入门/image-20240718095516170.png)

## 运行前端项目

我们打开终端命令行窗口，进入 `angular` 项目，运行以下命令进行依赖安装：

```shell
npm install
```

然后运行以下命令，启动应用：

```shell
npm start
```

成功运行后，浏览器会打开前端页面，效果如下：

![前端页面](images/02_快速入门/image-20240718110336848.png)

我们可以点击登录按钮，初始账号信息如下：

- 用户名：`admin`
- 密码：`1q2w3E*`

## 创建实体

在领域驱动设计（DDD）中，实体是核心概念，它代表了具有唯一标识的对象，通常会随着业务操作而改变它的状态。实体通常映射到关系型数据库的表中。

::: tip

实体的主要特征是即使其属性发生变化，只要其唯一标识（ID）保持不变，它仍然被认为是同一个实体。例如，一个人的姓名、地址等信息可能会变，但只要身份证号（假设用作唯一标识）不变，那么无论他的哪些属性如何变化，都认为是同一个人。

:::

接下来，我们在 `TodoApp.Domain` 项目中新建一个 `TodoItem` 类：

```csharp
using System;
using Volo.Abp.Domain.Entities;

namespace TodoApp
{
    public class TodoItem : BasicAggregateRoot<Guid>
    {
        public string Text { get; set; }
    }
}
```

`BasicAggregateRoot` 是创建根实体的最简单的基础类。这表明 `TodoItem` 是一个聚合根，是领域驱动设计中的一个概念，代表领域模型的根实体。 `Guid` 是这里实体的主键 (`Id`)。

![image-20240719080723692](images/02_快速入门/image-20240719080723692.png)

下面，我们来设置 [Entity Framework Core](https://docs.abp.io/zh-Hans/abp/latest/Entity-Framework-Core) 配置。

## 将实体映射到数据库中的表

打开在 `TodoApp.EntityFrameworkCore` 项目中 `EntityFrameworkCore` 文件夹中的 `TodoAppDbContext` 类, 并向该类添加新的 `DbSet` 属性:

```csharp
public DbSet<TodoItem> TodoItems { get; set; }
```

![添加新的DbSet属性](images/02_快速入门/image-20240719081229395.png)

然后在当前这个 `TodoAppDbContext` 类中找到 `OnModelCreating` 方法，并为 `TodoItem` 实体添加映射代码:

```csharp
builder.Entity<TodoItem>(b =>
{
	b.ToTable("TodoItems");
});
```

![为实体添加映射](images/02_快速入门/image-20240719081710213.png)

现在，我们就已经将 `TodoItem` 实体映射到数据库中的 `TodoItems` 表。

## Code First 迁移

该模板配置的是Entity Framework Core的 [Code First 迁移](https://docs.microsoft.com/en-us/ef/core/managing-schemas/migrations)。

由于我们更改了数据库映射配置，因此需要创建一个新的迁移并将更改应用于数据库。

在 `TodoApp.EntityFrameworkCore` 项目目录中打开一个命令行终端并输入以下命令：

```bash
dotnet ef migrations add Added_TodoItem
```

这将向项目添加一个新的迁移类。接着运行这条命令，将更改应用于数据库：

```bash
dotnet ef database update
```

![迁移](images/02_快速入门/image-20240719153242029.png)

现在，我们可以使用ABP仓库保存和检索待办事项。

### 
